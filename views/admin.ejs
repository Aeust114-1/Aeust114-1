<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>用戶審核</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../public/css/<%= theme %>.css">
</head>
<body class="bg-light p-5">
    <div class="container bg-white p-4 rounded shadow">
        <div class="d-flex justify-content-between mb-3">
            <h3>🛡️ 新用戶註冊審核</h3>
            <a href="/dashboard" class="btn btn-secondary">返回儀表板</a>
        </div>
        <table class="table">
            <thead><tr><th>Email</th><th>狀態</th><th>操作</th></tr></thead>
            <tbody>
                <% if (pendingUsers.length > 0) { %>
                    <% pendingUsers.forEach(u => { %>
                    <tr>
                        <td><%= u.email %></td>
                        <td><span class="badge bg-warning text-dark"><%= u.status %></span></td>
                        <td>
                            <button class="btn btn-success btn-sm" onclick="doReview('<%= u.EmailId %>', 'approve')">核准</button>
                            <button class="btn btn-danger btn-sm" onclick="doReview('<%= u.EmailId %>', 'reject')">拒絕</button>
                        </td>
                    </tr>
                    <% }) %>
                <% } else { %>
                    <tr><td colspan="3">目前沒有待審核的用戶。</td></tr>
                <% } %>
            </tbody>
        </table>
    </div>
    <script>
        function doReview(id, action) {
            if(!confirm('確定執行？')) return;
            fetch('/api/approve', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({id, action})
            }).then(() => location.reload());
        }
    </script>
</body>
</html>